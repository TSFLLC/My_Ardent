Do this now (step-by-step)
1) Make sure the shared variables exist

In App.OnStart (then App ‚Üí Run OnStart):

Set(vDeptCode, "EDG");
Set(vYear, Year(Today()));
Set(vQuarter, With({m: Month(Today())}, If(m<=3,"Q1", If(m<=6,"Q2", If(m<=9,"Q3","Q4")))));

2) Create the OnePager screen

Insert ‚Üí Screen ‚Üí rename to scrOnePager.

(If you copied dropdowns here already, great. If not, add the 3 classic Drop down controls and name them ddDept_OP, ddYear_OP, ddQuarter_OP.)

Hook the OnePager dropdowns to the variables:

ddDept_OP

Items: SortByColumns('kpi.Department', "Department", SortOrder.Ascending)

Value: "Department"

Default: LookUp('kpi.Department', DeptCode = vDeptCode, Department)

OnChange: Set(vDeptCode, Self.Selected.DeptCode)

ddYear_OP

Items: SortByColumns('kpi.vKPI_Years', "KPIYear", SortOrder.Descending)

Value: "KPIYear"

Default: vYear

OnChange: Set(vYear, Value(Self.Selected.KPIYear))

ddQuarter_OP

Items: ["Q1","Q2","Q3","Q4"] (or your dynamic quarter list)

Default: vQuarter

OnChange: Set(vQuarter, Self.Selected.Value)

(Optional header label at top)

LookUp('kpi.Department', DeptCode = vDeptCode, Department)
& " " & vQuarter & " " & Text(vYear) & " KPIs One Pager"

3) Insert the galRows gallery (the 4√ó4 one-pager)

Insert ‚Üí Gallery ‚Üí Flexible height (vertical) ‚Üí rename to galRows.

Set Items to this (this is the code you asked where to load it):

SortByColumns(
  Filter(
    'kpi.vKPI_OnePagerUX',
    DeptCode = vDeptCode,
    KPIYear  = vYear,
    IsBlank(vQuarter) || Quarter = vQuarter
  ),
  "Pillar",
  SortOrder.Ascending
)

4) Add the 4 columns inside each row

While galRows is selected, insert 4 Labels and rename them:

lblPillar, lblObj, lblPri, lblKpi

Text for each:

lblPillar.Text = ThisItem.Pillar
lblObj.Text    = ThisItem.ObjectivesText
lblPri.Text    = ThisItem.PrioritiesText
lblKpi.Text    = ThisItem.KPIsText


Layout (make 4 equal columns)

For all 4: Wrap = true, AutoHeight = true, Y = 8, Padding = 8, BorderThickness = 1

Width for all: Parent.TemplateWidth/4 - 16

X positions:

lblPillar.X = 8
lblObj.X    = Parent.TemplateWidth/4 + 8
lblPri.X    = Parent.TemplateWidth/2 + 8
lblKpi.X    = Parent.TemplateWidth*3/4 + 8


Row height so it grows to tallest cell:

galRows.TemplateSize =
    Max(lblPillar.Height, lblObj.Height, lblPri.Height, lblKpi.Height) + 24

5) Add the header row (column titles)

Insert 4 Labels above the gallery with the same X/Width formulas as the cells.
Texts:

‚ÄúArdent Pillar‚Äù

‚ÄúTCS Objectives‚Äù

‚ÄúEnterprise D&A Priorities‚Äù

‚ÄúEDG KPIs‚Äù

(Style: bold, light fill, border 1.)

6) (Optional) Color mapping by Pillar (polish)

Add once (App.OnStart, then Run OnStart):

ClearCollect(
  colPillarColors,
  { Pillar:"People First",       Hex:"#0F4C81" },
  { Pillar:"Value Driven",       Hex:"#005EAA" },
  { Pillar:"Consumer Centered",  Hex:"#008B8B" },
  { Pillar:"Growth Minded",      Hex:"#6A4C93" }
);


Then:

lblPillar.Fill

With({c: ColorValue(LookUp(colPillarColors, Pillar = ThisItem.Pillar, "#0F4C81"))}, c)


lblObj.Fill, lblPri.Fill, lblKpi.Fill

With({c: ColorValue(LookUp(colPillarColors, Pillar = ThisItem.Pillar, "#0F4C81"))},
    ColorFade(c, 0.85)
)


lblObj.BorderColor / lblPri.BorderColor / lblKpi.BorderColor

With({c: ColorValue(LookUp(colPillarColors, Pillar = ThisItem.Pillar, "#0F4C81"))},
    ColorFade(c, -0.30)
)

7) Update Screen1 (list) or hide it

If you keep Screen1‚Äôs gallery, set its Items to the same formula as galRows (using vDeptCode/vYear/vQuarter).

Or set Screen1.Visible = false if you only want OnePager.

------------------------------------------------------------------

Step 1 ‚Äî PROVE the basic table works (no GroupBy yet)

Select galRows ‚Üí Items and paste this minimal formula (no With, no AddColumns):

Filter(
    'kpi.vKPI_OnePagerUX',
    DeptCode = vDeptCode &&
    KPIYear  = vYear &&
    ( IsBlank(vQuarter) || Quarter = vQuarter )
)


What you should see: the gallery shows one card per row from the view for your Dept/Year/Quarter (you can temporarily put a label inside the gallery with ThisItem.Pillar to check).

If this is red: your data source alias or field names don‚Äôt match. Drop a label somewhere and set
Mid(JSON(First('kpi.vKPI_OnePagerUX')),1,1200) and use the exact names you see there.

Step 2 ‚Äî Group by Pillar (only)

Now change galRows ‚Üí Items to:

GroupBy(
    Filter(
        'kpi.vKPI_OnePagerUX',
        DeptCode = vDeptCode &&
        KPIYear  = vYear &&
        ( IsBlank(vQuarter) || Quarter = vQuarter )
    ),
    "Pillar",       // group key
    "rows"          // name for the nested table
)


What you should see: one card per pillar (4 cards).

Inside the gallery, set one label‚Äôs Text to ThisItem.Pillar to confirm.

If you get ‚ÄúPillar isn‚Äôt recognized‚Äù here, it means the column isn‚Äôt named exactly Pillar in your view. Use the JSON check and replace "Pillar" above with the exact name you see.

Step 3 ‚Äî Add the aggregates and order

If Step 2 works, replace Items with the final version below (uses an alias As g so references are crystal-clear, and feeds Concat with a single-column table via ShowColumns):

SortByColumns(
    AddColumns(
        GroupBy(
            Filter(
                'kpi.vKPI_OnePagerUX',
                DeptCode = vDeptCode &&
                KPIYear  = vYear &&
                ( IsBlank(vQuarter) || Quarter = vQuarter )
            ),
            "Pillar",
            "rows"
        ) As g,
        "_ord",
        Switch(
            Lower(Trim(g.Pillar)),
            "people first",        1,
            "value driven",        2,
            "consumer centered",   3,
            "growth minded",       4,
            999
        ),
        "ObjectivesAgg",
        Concat( ShowColumns(g.rows, "ObjectivesText"), ObjectivesText, Char(10) ),
        "PrioritiesAgg",
        Concat( ShowColumns(g.rows, "PrioritiesText"), PrioritiesText, Char(10) ),
        "KPIAgg",
        Concat( ShowColumns(g.rows, "KPIsText"), KPIsText, Char(10) )
    ),
    "_ord",
    SortOrder.Ascending
)


Important

Type straight quotes " " (not curly).

If your view‚Äôs fields are named slightly differently (e.g., KPIText not KPIsText, or ObjectiveText), change the three field names inside ShowColumns(...) accordingly.

Wire up the 4 cell labels

Inside galRows:

lblPillar.Text = ThisItem.Pillar

lblObj.Text = ThisItem.ObjectivesAgg

lblPri.Text = ThisItem.PrioritiesAgg

lblKpi.Text = ThisItem.KPIAgg

Set Wrap = true and AutoHeight = true on all four labels.

Gallery row height:

// galRows.TemplateSize
Max(lblPillar.Height, lblObj.Height, lblPri.Height, lblKpi.Height) + 24

If anything is still red

Put this on a label (outside the gallery) to see exact field names:

Mid(JSON(First('kpi.vKPI_OnePagerUX')),1,1200)


Then edit the 3 ShowColumns(...,"ObjectivesText"/"PrioritiesText"/"KPIsText")
to match exactly.

If Step 1 fails: remove and re-add the data source so Power Apps refreshes the schema (Data pane ‚Üí ‚Ä¶ ‚Üí Remove ‚Üí Add data ‚Üí SQL ‚Üí Views ‚Üí pick kpi.vKPI_OnePagerUX).

Follow the steps exactly (Step 1 ‚Üí Step 2 ‚Üí Step 3). Once Step 2 works (one card per pillar), Step 3 will compile and your labels (ThisItem.ObjectivesAgg, etc.) will stop showing red.




[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[

A) Build a clean base collection on the One-Pager screen

Go to scrOnePager.

Select the screen (not the gallery). Set its OnVisible to:

// 1) Capture selections from your three dropdowns
Set(vDeptCode, ddDept_op.Selected.DeptCode);
Set(vYear,     Value(Coalesce(ddYear_op.Selected.KPIYear, ddYear_op.Selected.Value, ddYear_op.Selected.Result)));
Set(vQuarter,  ddQuarter_op.Selected.Value);

// 2) Load a flat collection with only the rows we need
ClearCollect(
    colBase,
    Filter(
        'kpi.vKPI_OnePagerUX',
        DeptCode = vDeptCode,
        KPIYear  = vYear,
        IsBlank(vQuarter) || Quarter = vQuarter
    )
);


With scrOnePager still selected, click Run OnVisible (in the ribbon).
(Or navigate away and back to the screen.)
üëâ If you want to sanity-check: add a temporary label and set
Text = "colBase rows = " & CountRows(colBase) ‚Äî you should see a number > 0 for EDG / 2025 / Q3.

B) Drive the gallery from the collection (no datasource quirks)

Select galRows ‚Üí set Items to:

SortByColumns(
  AddColumns(
    GroupBy(colBase, "Pillar", "rows"),
    "_ord",
    Switch(
      Lower(Trim(Pillar)),
      "people first",       1,
      "value driven",       2,
      "consumer centered",  3,
      "growth minded",      4,
      999
    ),
    "ObjectivesAgg",
      Concat( ShowColumns(rows, "ObjectivesText"),  ObjectivesText,  Char(10) ),
    "PrioritiesAgg",
      Concat( ShowColumns(rows, "PrioritiesText"),  PrioritiesText,  Char(10) ),
    "KPIAgg",
      Concat( ShowColumns(rows, "KPIsText"),        KPIsText,        Char(10) )
  ),
  "_ord",
  SortOrder.Ascending
)


TYPE the quotes in Power Apps (straight " "). Don‚Äôt paste curly quotes.
If your field names are slightly different, change only the three names inside ShowColumns(...).

Inside galRows, set the four cell labels:

lblPillar.Text = ThisItem.Pillar

lblObj.Text = ThisItem.ObjectivesAgg

lblPri.Text = ThisItem.PrioritiesAgg

lblKpi.Text = ThisItem.KPIAgg

Turn Wrap = On and AutoHeight = On for each label.

Set row height to auto:

// galRows.TemplateSize
Max(lblPillar.Height, lblObj.Height, lblPri.Height, lblKpi.Height) + 24

C) Make the dropdowns drive the data

On each dropdown‚Äôs OnChange, refresh the collection:

// ddDept_op.OnChange, ddYear_op.OnChange, ddQuarter_op.OnChange:
Set(vDeptCode, ddDept_op.Selected.DeptCode);
Set(vYear,     Value(Coalesce(ddYear_op.Selected.KPIYear, ddYear_op.Selected.Value, ddYear_op.Selected.Result)));
Set(vQuarter,  ddQuarter_op.Selected.Value);

ClearCollect(
    colBase,
    Filter(
        'kpi.vKPI_OnePagerUX',
        DeptCode = vDeptCode,
        KPIYear  = vYear,
        IsBlank(vQuarter) || Quarter = vQuarter
    )
);


Optional (nice UX): after you rebuild colBase, call Reset(galRows).

D) If anything still turns red

Drop a temporary label and set:

Mid(JSON(First('kpi.vKPI_OnePagerUX')),1,1200)


Check the exact field names. If you see KPIText (not KPIsText) or ObjectiveText, update those three names in the ShowColumns(...) lines.

If CountRows(colBase) shows 0, it‚Äôs just a selection issue. Try Dept=EDG, Year=2025, Quarter=Q3 (you know those exist).

Make sure the 4 labels are inside the gallery (under galRows in the tree). If a label sits under the screen, ThisItem.* will be red.

This approach (collection ‚ûú GroupBy ‚ûú Concat) is the most forgiving and avoids the schema/quote pitfalls that were tripping you up. Follow A ‚Üí B ‚Üí C in order, and you‚Äôll have the grid filled with the correct, merged text per pillar‚Äîmatching the
finished one-pager your manager expects.

111111111111111111111111111111111111112222222222222222222222222222222222222222222233333333333333333333333333333333333333333333333333

1) Configure the Year dropdown (ddYear_op)

Pick ONE of these. I recommend Option A because you said you have kpi.vKPI_Years.

Option A ‚Äî use the kpi.vKPI_Years view

Select ddYear_op
Items:

Sort('kpi.vKPI_Years', KPIYear, SortOrder.Descending)


In the right panel Fields ‚Üí Value, type:

KPIYear


(Now the selected record has a field KPIYear.)

Option B ‚Äî build from the OnePager view (if you don‚Äôt want the Years view)

Items:

SortByColumns(
  Distinct('kpi.vKPI_OnePagerUX', KPIYear),
  "Result",
  SortOrder.Descending
)


Fields ‚Üí Value:

Result


(Now the selected record has a field Result.)

Decide and stick with one. The rest of the code below assumes Option A (KPIYear). If you use Option B, change .Selected.KPIYear to Value(.Selected.Result) where noted.

2) OnVisible for scrOnePager (simple + reliable)

Select scrOnePager ‚Üí OnVisible and paste:

// Grab current selections
Set(vDeptCode, ddDept_op.Selected.DeptCode);
Set(vYear,     ddYear_op.Selected.KPIYear);     // <-- if you used Option B, use: Value(ddYear_op.Selected.Result)
Set(vQuarter,  ddQuarter_op.Selected.Value);

// Build the base rows for the gallery
ClearCollect(
    colBase,
    Filter(
        'kpi.vKPI_OnePagerUX',
        DeptCode = vDeptCode,
        KPIYear  = vYear,
        IsBlank(vQuarter) || Quarter = vQuarter
    )
);


(If you want a blank Quarter choice, set ddQuarter_op.AllowEmptySelection = true.)

Also put the same block on OnChange of each dropdown (Dept/Year/Quarter) so the grid refreshes when the user changes a selection.

3) Gallery Items (unchanged, uses colBase)

Select galRows ‚Üí Items:

SortByColumns(
  AddColumns(
    GroupBy(colBase, "Pillar", "rows"),
    "_ord",
    Switch(
      Lower(Trim(Pillar)),
      "people first",       1,
      "value driven",       2,
      "consumer centered",  3,
      "growth minded",      4,
      999
    ),
    "ObjectivesAgg", Concat( ShowColumns(rows, "ObjectivesText"),  ObjectivesText,  Char(10) ),
    "PrioritiesAgg", Concat( ShowColumns(rows, "PrioritiesText"),  PrioritiesText,  Char(10) ),
    "KPIAgg",        Concat( ShowColumns(rows, "KPIsText"),        KPIsText,        Char(10) )
  ),
  "_ord",
  SortOrder.Ascending
)


Inside galRows set:

lblPillar.Text = ThisItem.Pillar

lblObj.Text = ThisItem.ObjectivesAgg

lblPri.Text = ThisItem.PrioritiesAgg

lblKpi.Text = ThisItem.KPIAgg
and turn Wrap + AutoHeight = On for each.
galRows.TemplateSize = Max(lblPillar.Height, lblObj.Height, lblPri.Height, lblKpi.Height) + 24

4) 10-second sanity checks

Drop a temporary label (outside the gallery) to confirm:

"Dept=" & vDeptCode & " | Year=" & vYear & " | Q=" & Coalesce(vQuarter,"<blank>")


Another label:

"colBase rows = " & CountRows(colBase)


You should see > 0 for a combination that exists (EDG / 2025 / Q3).

Why the errors happened

Your Year dropdown wasn‚Äôt configured to expose Result or Value, so ddYear_op.Selected.Result / .Value didn‚Äôt exist‚Äîand the outer Value(...) then also flagged as ‚Äúnot recognized‚Äù. By setting the dropdown‚Äôs Value field explicitly and using exactly that field in OnVisible, everything lines up.

If you still see red after this, tell me which Option you used for the Year dropdown and what Fields ‚Üí Value is set to; I‚Äôll give the exact one-liner for Set(vYear, ‚Ä¶) to match it.

